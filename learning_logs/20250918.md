# CUD 관련 수업

## DDL

1. Database 생성

```sql
CREATE DATABASE 데이터베이스명;
```

2. 특정 DB의 사용

```sql
USE DB명;
```

3. 테이블 생성

```sql
CREATE TABLE 테이블명(
  컬럼1 속성1, 속성2, ...,
  컬럼2 속성a, 속성b, ...
);
CREATE TABLE students (
	student_id INT AUTO_INCREMENT PRIMARY KEY,
	student_name VARCHAR(100) NOT NULL,
	enrollment_date DATE NOT NULL
);
```

4. 컬럼 추가 SQL

```sql
ALTER TABLE 테이블명 ADD COLUMN 컬럼명 속성1 속성2 속성3;
ALTER TABLE students ADD COLUMN student_email VARCHAR(100) NOT NULL
```

5. 컬럼 삭제

```sql
ALTER TABLE 테이블명 DROP COLUMN 컬럼명;
```

- 해당 컬럼의 모든 데이터가 영구적으로 삭제된다. 되돌리 수 없기 때문에 백업 등 사전 준비가 필요하다.

6. 컬럼 수정
   1. CHANGE
   ```sql
   ALTER TABLE 테이블명 CHANGE COLUMN 기존 컬럼명 새 컬럼명 자료형 조건;
   ```
   - CHANGE를 쓸 경우 컬럼명만 바꾸더라도 자료형과 조건을 전부 다 명시해 줘야 합니다.
   2. RENAME
   ```sql
   ALTER TABLE 테이블명 RENAME COLUMN 기존 컬럼명 TO 새 컬럼명
   ```
   - 이름만 변경하고 기존 자료형과 조건은 유지된다. DB에 따라 지원 여부가 갈리기 때문에 확인이 필요하다.
   3. 테이블 이름 수정
   ```sql
   ALTER TABLE 테이블명 RENAME TO 새 테이블명
   ```

## DML

- 컬럼에 값 추가

```sql
INSERT INTO 테이블명(컬럼명1, 컬럼명2, ..., 컬럼명n) VALUES(데이터a1, 데이터a2, ..., 데이터an),(데이터b1, 데이터b2, ..., 데이터bn);
INSERT INTO students (student_name, student_email, student_enrollment_date)
VALUES ('김일', 'kim1@test.com', '2025-09-18'),('김이', 'kim2@test.com', '2025-01-01');
```

이상의 코드에서는 student_id 가 자동으로 값이 오르는 AUTO_INCREAMENT가 적용되어있기 때문에 사용하지 값을 추가하지 않았다.

그리고 전체 컬럼에 차례대로 데이터를 입력한다고 가정하면 컬럼명을 입력하는 부분은 없어도 된다.  
하지만 실무 상에서는 어느 컬럼에 어떤 데이터를 넣었는지 명확하게 하기위해 항상 명시해 주는 편이다.

- 특정 데이터 수정

```sql
UPDATE 테이블명
SET 컴럼명 = 바꿀데이터값
WHERE 컴럼명 = 검색 가능한 데이터값;

UPDATE students
SET student_name = '김사백오십'
WHERE student_id = 1;
```

- 특정 데이터의 삭제

```sql
DELETE FROM 테이블명
WHERE 조건;


```

지시사항

1. '김삼','kim3@test.com' ,'2025-02-01' 데이터를 추가
2. '김사','kim4@test.com' ,'2025-03-01' 데이터를 추가

```sql
INSERT INTO students (student_name, student_email, student_enrollment_date)
VALUES ('김삼', 'kim3@test.com', '2025-02-01'),('김사', 'kim4@test.com', '2025-03-01')
```

3. 김삼 데이터 삭제

```sql
DELETE FROM students
WHERE student_name = '김삼';ㅣ
```

4. 김사 이름을 지니고 있는 데이터의 student_enrollment_date를 2024-04-04

```sql
UPDATE students
SET student_enrollment_date = '2025-04-04'
WHERE student_name = '김사';
```

5. select 문을 통해 김사 데이터만 콘솔에 출력

```sql
SELECT * FROM students WHERE student_name = '김사'
```

다음을 만족하는 테이블을 생성하시오
테이블명 : instructor
컬럼명 :

1. instructor_id / INT / PK / auto increment
2. name / varchar(100) / not null
3. email / varchar(100) / not null
4. hire_date / DATE / not null

```sql
CREATE TABLE instructor (
	instructor_id INT PRIMARY KEY AUTO_INCREMENT,
	NAME VARCHAR(100) NOT NULL,
	email VARCHAR(100) NOT NULL,
	hire_date DATE NOT NULL
	);
```

5. instructor 테이블에 다음과 같은 정보를 추가하시오
   이일 / 21@test.com / 2025-09-18
   이이 / 22@test.com / 2025-09-18
   이삼 / 23@test.com / 2025-09-18
   ```sql
   INSERT INTO instructor (NAME, email, hire_date)
   VALUES ('이일' ,'21@test.com', '2025-09-18'),
   		('이이' ,'22@test.com', '2025-09-18'),
   		('이삼' ,'23@test.com', '2025-09-18');
   ```

과목 테이블 courses를 생성
course_id / INT / primary key
course_name / varchar(100)
instructor_id / INT / FOREIGN KEY
stars_date / DATE
end_date / DATE

```sql
CREATE TABLE courses (
	course_id INT AUTO_INCREMENT PRIMARY KEY,
	coutse_name VARCHAR(100) NOT NULL,
	instructor_id INT NOT NULL,
	start_date DATE NOT NULL,
	end_date DATE NOT NULL,
	FOREIGN KEY (instructor_id) REFERENCES instructor(instructor_id)
	);
```

학생 id와 코스 id를 기본키와 외래키로 가지는 테이블 작성

```sql
CREATE TABLE student_courses(
	student_id INT NOT NULL,
	course_id INT NOT NULL,
	PRIMARY KEY(student_id, course_id),
	FOREIGN KEY(student_id) REFERENCES students(student_id),
	FOREIGN KEY(course_id) REFERENCES courses(course_id)
	);
```

```sql
CREATE TABLE attendence(
	attendence_id INT AUTO_INCREMENT PRIMARY KEY,
	student_id INT NOT NULL,
	course_id INT NOT NULL,
	date DATE NOT NULL,
	status VARCHAR(10) NOT NULL,
	FOREIGN KEY(student_id) REFERENCES students(student_id),
	FOREIGN KEY(course_id) REFERENCES courses(course_id)
	);
```

## 예제 데이터 삽입

-> attendence

```sql
INSERT INTO attendence (student_id, course_id, date, status) VALUES
(1,1, '2025-09-18', '출'),
(2,1, '2025-09-18', '결'),
(4,1, '2025-09-18', '출'),
(1,2, '2025-09-19', '출'),
(2,2, '2025-09-19', '출'),
(4,2, '2025-09-19', '결');
```

-> courses

```sql
INSERT INTO courses (course_name, instructor_id, start_date, end_date) VALUES
('Java',1,'2025-09-01','2025-09-30'),
('Python',2,'2025-09-02','2025-09-29');
```

-> instructor

```sql
INSERT INTO instructor (instructor_name, email, hire_date) VALUES
('김선생','kim@test.com','2025-07-01'),
('이선생','lee@test.com','2025-02-01');
```

-> students_course

```sql
INSERT INTO student_courses(student_id, course_id) VALUES
(1,1),
(1,2),
(1,3),
(2,1),
(2,2),
(2,2)
```

외래키로 지정할 경우 해당 키가 존재하지 않으면 에러가 발생하게 된다. 그러므로 에러가 발생하지 않도록 제대로 확인해야 한다.

수강생 목록 및 과목 조회
students/ student_courses/ courses 테이블을 결합하여, 각 학생의 이름과 그 학생이 수강하는 모든 과목명을 조회.

```sql
SELECT s.student_name, c.course_name
FROM students s
INNER JOIN student_courses sc
ON s.student_id = sc.student_id
INNER JOIN courses c
ON sc.course_id = c.course_id
ORDER BY s.student_name;
```

김사백오십 학생의 이름과 이메일 그리고 수강 과목을 출력하시오.

```sql
SELECT s.student_name, s.student_email ,c.course_name
FROM students s
INNER JOIN student_courses sc
ON s.student_id = sc.student_id
INNER JOIN courses c
ON sc.course_id = c.course_id
WHERE s.student_name = '김사백오십'
ORDER BY s.student_name;
```

이일 강사의 교수 과목과 수강생 수를 출력하시오.

```sql
SELECT i.instructor_name, c.course_name, COUNT(DISTINCT sc.student_id) AS student_cnt
FROM instructor i
INNER JOIN courses c
ON i.instructor_id = c.instructor_id
INNER JOIN student_courses sc
ON sc.course_id = c.course_id
WHERE i.instructor_name = '이일'
GROUP BY i.instructor_id
;
```

시험 문제

1. sql 활용 - 30문항 / 4지선다
2. sql 응용 - 50문항 /

- DB 생성/ 테이블 생성/ 컬럼 생성과 관련되 DDL
- 그리고 그 테이블에 맞는 데이터를 집어넣는 것 까지 다 문제화 되어 있습니다.
- 이상의 작업을 기준으로 나머지 URD에 해당하는 부분, 특히 R부분의 경우는 다향한 조건 및 그룹화, 그리고 정렬 순서와 관련된 모든 것들이 포함될 예정
